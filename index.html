<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>20/10 — Dành tặng Em</title>
<meta name="description" content="Một trang web nhỏ dành tặng em nhân ngày 20/10." />
<meta name="theme-color" content="#ff7aa2" />
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E%F0%9F%92%96%3C/text%3E%3C/svg%3E">

<style>
:root{
  --bg:#0a0a13;
  --txt:#f7f3ff;
  --muted:#c9b9d3;
  --primary:#ff7aa2;
  --accent:#ffd96a;
  --card:#ffffffcc;
  --shadow: 0 10px 25px rgba(255,122,162,.25);
  --radius:18px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Thay đổi font thành Segoe UI để hiện đại hơn */
  color:#ff7aa2; /* Thay đổi màu chữ thành hồng để phù hợp với chủ đề 20/10 */
  background:#fff8fb; line-height:1.6; overflow-x:hidden;
  text-shadow: 0 1px 2px rgba(255,255,255,0.5); /* Thêm shadow nhẹ để chữ nổi bật trên nền video */
}
a{color:inherit}
.container{width:min(1100px, 92vw); margin:0 auto;}

/* ===== INTRO (đêm: bầu trời sao + trái tim đập) ===== */
#intro{
  position:fixed; inset:0; z-index:1000;
  background: radial-gradient(1200px 700px at 50% -20%, #1a1730 0%, transparent 60%), #0a0a13;
  display:flex; align-items:center; justify-content:center; flex-direction:column; gap:18px; color:#eae4ff;
}
#introCanvas{ position:absolute; inset:0; width:100%; height:100%; }
.intro-content{ position:relative; text-align:center; z-index:2; padding:16px 20px; }
.intro-title{ font-size: clamp(22px, 5vw, 40px); margin:0 0 6px; letter-spacing:.3px }
.intro-sub{ margin:0 0 10px; color:#cfc6ff }
.pill{
  display:inline-flex; align-items:center; gap:.5rem; padding:10px 16px; border-radius:999px;
  background:var(--primary); color:#fff; border:none; box-shadow:0 10px 25px rgba(255,122,162,.35); cursor:pointer; font-weight:700;
}
.pill.ghost{ background:transparent; color:#ffdfe9; border:1px solid #ffb9cf }
.bounce{ animation: bounce 1.6s ease-in-out infinite }
@keyframes bounce{ 0%,100%{ transform:translateY(0)} 50%{ transform:translateY(-6px)} }

/* intro countdown (đặt trong intro) */
.intro-countdown{
  display:inline-flex; gap:10px; align-items:stretch; margin:12px 0 2px;
  padding:10px; border-radius:14px;
  background:linear-gradient(180deg, #171629cc, #131224cc); border:1px solid #3b355a;
  box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 0 20px #1c1a33;
}
.icell{ min-width:78px; padding:8px 10px; border-radius:10px; backdrop-filter: blur(6px);
  background:linear-gradient(180deg,#23213d,#1a1931);
  border:1px solid #4b4672; color:#f3eaff; text-align:center;
}
.icell .num{font-weight:800; font-size:22px}
.icell .lbl{font-size:12px; color:#bcb1ff; letter-spacing:.4px}

/* ===== VIDEO WALL BACKGROUND (hiện sau khi bắt đầu) ===== */
/* ===== VIDEO WALL BACKGROUND (6 ô — đẹp & gọn) ===== */
#videoBG{
  position:fixed; inset:0; z-index:0; pointer-events:none;
  opacity:0; transition:opacity .8s ease;
  display:grid;
  grid-template-areas:
    "a b c"
    "d e f";
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-rows: 50vh 50vh;
  gap:10px;
  padding:10px;
}

/* mobile/tablet: 2 cột × 3 hàng */
@media (max-width: 900px){
  #videoBG{
    grid-template-areas:
      "a b"
      "c d"
      "e f";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 34vh 34vh 34vh;
    gap:8px;
    padding:8px;
  }
}

/* scrim phủ toàn bộ để chữ dễ đọc */
#videoBG::after{
  content:"";
  position:absolute; inset:0; z-index:2;
  background:
    radial-gradient(1200px 800px at 70% 15%, rgba(10,8,20,.10) 0%, rgba(10,8,20,0) 60%),
    linear-gradient(180deg, rgba(10,8,20,.28), rgba(10,8,20,.38));
  backdrop-filter: blur(1.2px);
}

/* từng ô video */
.vcell{
  position:relative; overflow:hidden; border-radius:14px; z-index:1;
  outline:1px solid rgba(255,255,255,.06);
  box-shadow: 0 10px 30px rgba(0,0,0,.18) inset;
}
.vcell[data-area="a"]{ grid-area:a }
.vcell[data-area="b"]{ grid-area:b }
.vcell[data-area="c"]{ grid-area:c }
.vcell[data-area="d"]{ grid-area:d }
.vcell[data-area="e"]{ grid-area:e }
.vcell[data-area="f"]{ grid-area:f }

/* video bên trong ô */
.vcell video{
  position:absolute; inset:0; width:100%; height:100%; object-fit:cover;
  filter:saturate(1.07) contrast(1.05) brightness(.9);
  opacity:0; animation: fadeIn .9s ease forwards;
  transform: scale(1.04); /* base để ken-burns mượt */
}

/* object-position & pan khác nhau cho từng ô để tránh lặp cảm giác */
.vcell.a video{ object-position: 50% 40%; animation-name: fadeIn, panTR; }
.vcell.b video{ object-position: 30% 50%; animation-name: fadeIn, panBL; }
.vcell.c video{ object-position: 70% 50%; animation-name: fadeIn, panTB; }
.vcell.d video{ object-position: 50% 60%; animation-name: fadeIn, panLR; }
.vcell.e video{ object-position: 40% 50%; animation-name: fadeIn, panBR; }
.vcell.f video{ object-position: 60% 45%; animation-name: fadeIn, panTL; }

/* tốc độ ken-burns khác nhau nhẹ */
.vcell.a video{ animation-duration: .9s, 28s; }
.vcell.b video{ animation-duration: .9s, 30s; }
.vcell.c video{ animation-duration: .9s, 26s; }
.vcell.d video{ animation-duration: .9s, 32s; }
.vcell.e video{ animation-duration: .9s, 29s; }
.vcell.f video{ animation-duration: .9s, 31s; }
.vcell video{ animation-timing-function: ease, linear; }

/* fade-in + 6 hướng pan siêu nhẹ (không gây chóng mặt) */
@keyframes fadeIn{ from{opacity:0} to{opacity:1} }
@keyframes panTR{ from{transform:scale(1.04) translate(-1.5%, 1.5%)} to{transform:scale(1.08) translate(1.5%, -1.5%)} }
@keyframes panBL{ from{transform:scale(1.04) translate(1.2%, -1.2%)} to{transform:scale(1.08) translate(-1.2%, 1.2%)} }
@keyframes panTB{ from{transform:scale(1.04) translate(0, 1.8%)} to{transform:scale(1.08) translate(0, -1.8%)} }
@keyframes panLR{ from{transform:scale(1.04) translate(-2%, 0)} to{transform:scale(1.08) translate(2%, 0)} }
@keyframes panBR{ from{transform:scale(1.04) translate(1.2%, 1.2%)} to{transform:scale(1.08) translate(-1.2%, -1.2%)} }
@keyframes panTL{ from{transform:scale(1.04) translate(-1.2%, -1.2%)} to{transform:scale(1.08) translate(1.2%, 1.2%)} }


/* ===== CONTENT ===== */
main{ position:relative; z-index:2; }
.hero{ padding:80px 0 60px; text-align:center; }
.hero h1{ font-size: clamp(28px, 4vw + 10px, 54px); line-height:1.08; margin:0 0 12px; letter-spacing:.2px; color:#ff7aa2 }
.hero .subtitle{color:#ff7aa2; margin-bottom:22px}
.hero-card{ margin:22px auto 0; padding:24px; border-radius: var(--radius);
  background: linear-gradient(180deg, #fff, #fff7fa); box-shadow: var(--shadow); display:inline-block; }

/* (đã bỏ đồng hồ đếm ngược khỏi hero theo yêu cầu) */

section{padding:60px 0}
.sec-title{ font-size: clamp(22px, 2vw + 14px, 34px); margin:0 0 18px; color:#ff7aa2 }
.lead{color:#ff7aa2; margin-top:-6px; margin-bottom:18px}
.card{ background:#ffffffcc; border:1px solid #ffe0ec; border-radius:var(--radius); padding:16px 18px; box-shadow:var(--shadow); }

/* Traits */
.traits{ display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(210px,1fr)); }
.trait{ background:#fff; border:1px solid #ffd9e7; border-radius:16px; padding:16px; box-shadow: var(--shadow); transform: perspective(700px) rotateX(0) rotateY(0); transition: transform .12s ease, box-shadow .2s ease; }
.trait:hover{ box-shadow:0 16px 50px rgba(255,122,162,.35) }
.trait h3{margin:0 0 6px; font-size:18px}
.trait p{margin:0; color:#ff7aa2; font-size:14px}

/* Timeline */
.timeline{position:relative}
.timeline::before{ content:""; position:absolute; left:calc(50% - 1px); top:0; bottom:0; width:2px; background:linear-gradient(180deg, #ffc2d6, #ffd96a); }
.tl-item{ position:relative; width:calc(50% - 22px); margin:18px 0; padding:16px 18px; background:#fff; border:1px solid #ffd3e4; border-radius:14px; box-shadow:var(--shadow); }
.tl-item:nth-child(odd){margin-left:auto}
.tl-item::after{ content:""; position:absolute; top:18px; width:14px; height:14px; border-radius:50%; background:#ff7aa2; box-shadow:0 0 0 6px #ffe7f0aa; left: calc(100% + 14px); }
.tl-item:nth-child(odd)::after{left:auto; right: calc(100% + 14px)}
.tag{display:inline-block; padding:2px 10px; border-radius:999px; background:#fff0f5; color:#b13e68; font-size:12px; border:1px solid #ffd2e3; margin-bottom:8px}

/* Letter */
.letter{ background: linear-gradient(180deg, #fffdfa, #fff0f5); border:1px dashed #ffc8de; padding:22px; border-radius:16px; }
.typewriter{min-height:96px; font-size:18px}
.letter .actions{display:flex; gap:12px; margin-top:12px}

/* Carousel */
.carousel{ position:relative; overflow:hidden; border-radius:16px; border:1px solid #ffdbe7; box-shadow:var(--shadow); }
.track{ display:flex; width:max-content; animation: slide 26s linear infinite; }
.track img{ width:72vw; max-width:520px; height:320px; object-fit:cover; border-right:1px solid #ffe5ef }
@keyframes slide{ 0%{ transform: translateX(0) } 100%{ transform: translateX(-50%) } }
.carousel .hint{ position:absolute; right:10px; bottom:8px; font-size:12px; color:#b13e68; background:#fff; border:1px solid #ffd3e4; padding:4px 8px; border-radius:999px }

/* Quiz */
.quiz{ display:grid; gap:12px; }
.opt{ background:#fff; border:1px solid #ffd9e7; border-radius:12px; padding:12px; cursor:pointer; transition: transform .06s ease, box-shadow .2s ease, border-color .2s; }
.opt:hover{ box-shadow:0 10px 30px rgba(255,122,162,.25); transform: translateY(-2px); }
.opt.correct{ border-color:#8dd38a; background: #f4fff3; }
.opt.wrong{ border-color:#ffb0c6; background:#fff4f7; }
.quiz .result{ color:#b13e68; font-weight:700; }

/* Chips/Toast */
.chips{ display:flex; gap:8px; flex-wrap:wrap }
.chip{ background:#fff; border:1px solid #ffd3e4; border-radius:999px; padding:8px 12px; cursor:pointer }
.toast{
  position:fixed; left:50%; bottom:22px; transform:translateX(-50%) translateY(20px);
  background:#222; color:#fff; padding:10px 14px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.25);
  opacity:0; transition: all .3s ease; z-index:50;
}
.toast.show{ opacity:1; transform:translateX(-50%) translateY(0) }

/* Gallery */
.gallery{columns:1; column-gap:16px}
@media (min-width:700px){.gallery{columns:2}}
@media (min-width:1000px){.gallery{columns:3}}
.gallery img{ width:100%; border-radius:14px; margin:0 0 16px; display:block; border:1px solid #ffe1ed; box-shadow:var(--shadow); transition:transform .25s ease, box-shadow .25s ease; }
.gallery img:hover{transform:translateY(-4px) scale(1.01); box-shadow:0 16px 40px rgba(255,122,162,.35)}

/* Modal */
.modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.4); display:none; align-items:center; justify-content:center; z-index:40; }
.modal{background:#fff; border-radius:18px; max-width:520px; width:92vw; padding:22px; box-shadow:0 30px 80px rgba(0,0,0,.25)}
.modal h3{margin-top:0}
.qr{ background:repeating-conic-gradient(from 0deg, #eee 0 10deg, #fff 10deg 20deg); width:220px; height:220px; border-radius:12px; display:flex; align-items:center; justify-content:center; margin:10px auto; border:1px solid #f1f1f1; color:#777; font-weight:700; }
.modal .row{display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
.modal .row .pill{background:#222; color:#fff;}

footer{padding:40px 0 80px; text-align:center; color:#7a4b62}
.sign{font-weight:800; color:#ff7aa2}
#hearts{
  position:fixed;
  inset:0;
  z-index:5;          /* trên video, dưới nội dung */
  pointer-events:none;/* <<< quan trọng: không chặn click */
}
/* Tilt mượt & nổi khối */
.trait{
  will-change: transform;
  transform-style: preserve-3d;
}
.trait::after{
  content:"";
  position:absolute; inset:0; border-radius:16px; pointer-events:none;
  background: radial-gradient(600px 300px at var(--lx,50%) var(--ly,50%),
              rgba(255,255,255,.35), rgba(255,255,255,0) 60%);
  opacity:.0; transition: opacity .2s ease;
}
.trait:hover::after{ opacity:.55; }

@media (prefers-reduced-motion: reduce){
  .trait{ transform:none !important }
  .trait::after{ display:none }
}

@media (prefers-reduced-motion: reduce){ .track{ animation: none } }
</style>
</head>
<body>

<!-- INTRO: Night sky + beating star heart + COUNTDOWN -->
<div id="intro" role="dialog" aria-modal="true" aria-label="Màn mở đầu đêm sao">
  <canvas id="introCanvas"></canvas>
  <div class="intro-content">
    <h1 class="intro-title">Cho Em — 20/10 dưới bầu trời sao ✨</h1>
    <!-- COUNTDOWN moved into intro -->
    <div class="intro-countdown" aria-label="Đếm ngược tới 20/10">
      <div class="icell"><div class="num" id="dd">--</div><div class="lbl">Ngày</div></div>
      <div class="icell"><div class="num" id="hh">--</div><div class="lbl">Giờ</div></div>
      <div class="icell"><div class="num" id="mm">--</div><div class="lbl">Phút</div></div>
      <div class="icell"><div class="num" id="ss">--</div><div class="lbl">Giây</div></div>
    </div>
    <p class="intro-sub">Nhấn “Bắt đầu” để mở nhạc và bước vào vùng ký ức của hai ta.</p>
    <button id="btnEnter" class="pill bounce">▶️ Bắt đầu</button>
    <div><button id="btnMuteHint" class="pill ghost">Nếu không nghe nhạc, hãy bật âm thanh 🔊</button></div>
  </div>
</div>

<!-- Video mosaic background (revealed after start) -->
<div id="videoBG" aria-hidden="true"></div>

<!-- Hearts (foreground particles) -->
<canvas id="hearts" aria-hidden="true"></canvas>

<main aria-live="polite">
  <!-- HERO (không còn countdown ở đây) -->
  <section class="hero">
    <div class="container">
      <h1>Gửi Em — người con gái đặc biệt nhất ngày <span style="color:#ff7aa2">20/10</span> 💐</h1>
      <p class="subtitle">Cám ơn Em vì đã đến và làm cuộc đời anh rực rỡ như nắng sớm. Hôm nay, xin dành trọn trang này cho Em.</p>
      <div class="hero-card">
        <div class="center">Chúc Em một ngày 20/10 rạng rỡ — như chính Em. ✨</div>
      </div>
    </div>
  </section>

  <!-- Vì sao Em tuyệt? -->
  <section>
    <div class="container">
      <h2 class="sec-title">Vì sao Em tuyệt? 💖</h2>
      <p class="lead">6 điều khiến anh thích em từ cái nhìn đầu.</p>
      <div class="traits">
        <div class="trait"><h3>🌞 Nụ cười</h3><p>Làm anh vui mỗi khi thấy em.</p></div>
        <div class="trait"><h3>🧠 Thông minh</h3><p>Nói ít nhưng trúng trọng tâm.</p></div>
        <div class="trait"><h3>💪 Kiên định</h3><p>Đi đến cùng điều Em chọn.</p></div>
        <div class="trait"><h3>🎨 Gu riêng</h3><p>Đồ Em chọn — luôn xịn trừ đồ ăn .</p></div>
        <div class="trait"><h3>🤍 Thể thao</h3><p>Thích thể thao.</p></div>
        <div class="trait"><h3>🌿 Điềm tĩnh</h3><p>Cho anh cảm giác an yên.</p></div>
      </div>
    </div>
  </section>

  <!-- TIMELINE -->
  <section id="story">
    <div class="container">
      <h2 class="sec-title">Chuyện đôi mình</h2>
      <p class="lead">Vài mốc nhỏ… nhưng là cả bầu trời lớn của anh.</p>
      <div class="timeline">
        <div class="tl-item">
          <span class="tag">06/03/2025 - Ngày đầu gặp</span>
          <h3>Ánh mắt hôm ấy</h3>
          <p>Quán ăn vỉa hè, hàng ghế công viên, chiếc áo trắng của Em và nụ cười vô tình làm lạc nhịp tim anh.</p>
        </div>
        <div class="tl-item">
          <span class="tag">12/03/2025 - Buổi hẹn hò xem phim đầu tiên</span>
          <h3>Trời đêm thiệt đẹp</h3>
          <p>Khoác tay anh, Em nói em thích xem phim <b>hài</b>. Anh thì thích Em — thật nhiều.</p>
        </div>
        <div class="tl-item">
          <span class="tag">03/08/2025 - Chuyến đi chơi xa đầu tiên</span>
          <h3>Biển xanh & Tiếng cười & Núi cao & Đồ ăn ngon</h3>
          <p>Có em phái sau xe , cùng anh leo núi . cùng anh gặp <b> Xu </b>, Cùng anh ăn ngon.</p>
        </div>
        <div class="tl-item">
          <span class="tag">Hôm nay</span>
          <h3>20/10 — Em xứng đáng</h3>
          <p>Mỗi ngày anh đều muốn Em vui vẻ hạnh phúc, được yêu thương và luôn tự tin về chính mình. Và đặc biệt luôn có anh sát cánh cùng em.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- LETTER -->
  <section>
    <div class="container">
      <h2 class="sec-title">Thư gửi Em</h2>
      <div class="letter">
        <div id="typewriter" class="typewriter" aria-live="polite"></div>
        <div id="fullLetter" class="hidden mt-12">
          Ý yêu, <br>
          Cảm ơn Em vì đã kiên nhẫn, dịu dàng và luôn tin ở anh, bên cạnh anh mọi lúc mọi khoảng khắc. Anh hứa sẽ chăm chỉ hơn, lắng nghe nhiều hơn, và cùng Em đi qua mọi bình minh lẫn giông gió , cùng em trải qua kỷ niệm thời sinh viên. Chúc Em 20/10 rạng rỡ — như chính Em. <br>
          <strong>Thương Em nhiều - Ý yêu của anh! 💞</strong>
        </div>
        <div class="actions">
          <button class="pill" id="btnReveal">Xem hết</button>
          <button class="pill ghost" id="btnHearts">Bắn tim</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Kỷ niệm dạng Carousel tự chạy -->
  <section>
    <div class="container">
      <h2 class="sec-title">Kỷ niệm trôi êm</h2>
      <p class="lead">Ảnh sẽ tự lướt nhẹ, như những ngày bình yên mình bên nhau.</p>
      <div class="carousel" id="carousel">
        <div class="track" id="track">
          <img src="assets/anh1.jpg" alt="Kỷ niệm 1">
          <img src="assets/anh2.jpg" alt="Kỷ niệm 2">
          <img src="assets/anh3.jpg" alt="Kỷ niệm 3">
          <img src="assets/anh4.jpg" alt="Kỷ niệm 4">
          <img src="assets/anh5.jpg" alt="Kỷ niệm 1 copy">
          <img src="assets/anh6.jpg" alt="Kỷ niệm 2 copy">
          <img src="assets/anh7.jpg" alt="Kỷ niệm 3 copy">
          <img src="assets/anh8.jpg" alt="Kỷ niệm 4 copy">
          <img src="assets/anh9.jpg" alt="Kỷ niệm 4 copy">
        </div>
        <div class="hint">Tự chạy • chạm để dừng</div>
      </div>
    </div>
  </section>

  <!-- Mini-Quiz -->
  <section>
    <div class="container">
      <h2 class="sec-title">Mini-quiz “Bắt bài Anh Nào” 😁</h2>
      <p class="lead">Điều gì ở em Ý mà anh thích nhất? </p>
      <div class="quiz" id="quiz">
        <div class="opt">A. Nụ cười</div>
        <div class="opt">B. Ánh mắt</div>
        <div class="opt">C. Tính cách</div>
        <div class="opt">D. Tất cả những điều trên</div>
        <div class="result mt-8" id="quizResult"></div>
      </div>
    </div>
  </section>

  <!-- Hẹn hò kế tiếp -->
  <section>
    <div class="container">
      <h2 class="sec-title">Hẹn hò kế tiếp 🌙</h2>
      <p class="lead">Em chọn nhé, anh sẽ lên lịch dẫn cục dàng đi:</p>
      <div class="chips" id="chips">
        <span class="chip">❤️ Phim + jollibee (như ngày đầu 🤭) </span>
        <span class="chip">🍣 Dokki</span>
        <span class="chip">🌳 Đi thảo cầm viên</span>
        <span class="chip">🎨 Đi chụp ảnh</span>
        <span class="chip">☕ Cà phê chill chill</span>
        <span class="chip">🎵 Về nhà cùng anh thư giãn</span>
      </div>
    </div>
  </section>

  <!-- GALLERY -->
  <section>
    <div class="container">
      <h2 class="sec-title">Album nhỏ của chúng mình</h2>
      <div class="gallery" aria-label="Bộ sưu tập ảnh">
        <img src="/assets/anh2.jpg" alt="Kỷ niệm 1">
        <img src="/assets/anh3.jpg" alt="Kỷ niệm 2">
        <img src="/assets/anh9.jpg" alt="Kỷ niệm 3">
        <img src="/assets/anh4.jpg" alt="Kỷ niệm 4">
        <img src="/assets/anh6.jpg" alt="Kỷ niệm 5">
        <img src="/assets/anh7.jpg" alt="Kỷ niệm 6">
      </div>
    </div>
  </section>

  <!-- GIFT -->
  <section class="center">
    <div class="container">
      <h2 class="sec-title">Một món quà nhỏ cho Em</h2>
      <p class="lead">Không phải đắt tiền xa xỉ, chỉ là tất cả yêu thương anh có.</p>
      <button class="pill" id="btnGift">🎁 Mở quà</button>
      <div class="mt-12">
        <button class="pill ghost" id="btnSecret" title="Nhấn & giữ 2 giây" style="margin-top: 20px;">🔒 Nhấn & giữ để mở bí mật</button>
      </div>
    </div>
  </section>
</main>

<!-- MODAL (bổ sung) -->
<div id="backdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="giftTitle" aria-describedby="giftDesc" style="display:none">
  <div class="modal">
    <h3 id="giftTitle">Voucher ôm + hôn + trà sữa</h3>
    <p id="giftDesc">Quét QR để nhận quyền lợi: 999 nụ hôn và 1 ly trà sữa , 1 phần quà bất kỳ 🥤💋</p>
    <div class="qr" style="padding:0; border:none">
      <!-- thay ảnh QR thật của bạn -->
      <img src="assets/qr.png" alt="QR Gift" style="width:220px;height:220px;border-radius:12px;display:block;">
    </div>
    <div class="row">
      <button class="pill" id="btnConfetti">Bắn pháo tim</button>
      <button class="pill ghost" id="btnClose">Đóng</button>
    </div>
  </div>
</div>

<footer>
  <div class="container">
    <p>Trang này được làm riêng cho <span class="sign">Em</span>. Cảm ơn vì đã đến bên anh. 🌙</p>
    <p class="mt-8">P/S: Nhấn đôi vào nền để tim bay nhiều hơn nha 💘</p>
  </div>
</footer>

<!-- Audio -->
<audio id="bgm" preload="auto" loop>
  <source src="assets/music.mp3" type="audio/mpeg">
</audio>

<div class="toast" id="toast">Đã lưu lịch hẹn 💌</div>

<script>
/* ===== Helpers & DPR ===== */
const $ = (sel, scope=document) => scope.querySelector(sel);
const DPR = Math.min(window.devicePixelRatio || 1, 2);

/* ===== INTRO: Night sky + beating star heart (heart nhỏ hơn, sao đậm hơn) ===== */
(() => {
  const cvs = $("#introCanvas");
  const ctx = cvs.getContext("2d");
  let W=0, H=0, stars=[];
  const STAR_N = 240; // hơi dày hơn 1 chút
  function resize(){
    W = cvs.width = Math.floor(innerWidth * DPR);
    H = cvs.height = Math.floor(innerHeight * DPR);
  }
  addEventListener("resize", resize, {passive:true}); resize();

  function initStars(){
    stars = Array.from({length:STAR_N}, () => ({
      x: Math.random()*W,
      y: Math.random()*H,
      r: (Math.random()*2.0 + 0.8)*DPR,   // to hơn nhẹ
      a0: Math.random()*0.35 + 0.55,      // sáng (đậm) hơn: 0.55–0.90
      t: Math.random()*Math.PI*2,
      tw: 0.012 + Math.random()*0.02
    }));
  }
  initStars();

  function drawStarfield(){
    // additive blending giúp sao “đậm” hơn khi chồng sáng
    ctx.save();
    ctx.globalCompositeOperation = "lighter";
    for(const s of stars){
      s.t += s.tw;
      const a = Math.min(1, s.a0 + Math.sin(s.t)*0.25);
      // lõi trắng + viền hồng tím mờ
      const grd = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r*2.2);
      grd.addColorStop(0, `rgba(255,255,255,${a})`);
      grd.addColorStop(1, `rgba(210,170,255,${a*0.25})`);
      ctx.fillStyle = grd;
      ctx.beginPath(); ctx.arc(s.x, s.y, s.r*2.2, 0, Math.PI*2); ctx.fill();

      // drift nhẹ
      s.x += 0.02*DPR; s.y += 0.01*DPR;
      if (s.x>W+12) s.x=-12; if (s.y>H+12) s.y=-12;
    }
    ctx.restore();
  }

  // Trái tim sao — thu nhỏ ~25–30%
  function heartPoint(t){
    const x = 16*Math.pow(Math.sin(t),3);
    const y = 13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
    return {x, y};
  }
  let beatT = 0;
  function drawHeart(){
    beatT += 0.06;
    const beat = 1 + Math.sin(beatT)*0.06;
    const scale = Math.min(W,H)*0.038*beat; // ↓ nhỏ hơn so với 0.05
    const cx = W/2, cy = H/2 - 10*DPR;
    const dots = 420;
    for (let i=0;i<dots;i++){
      const t = (i/dots) * Math.PI*2;
      const p = heartPoint(t);
      const x = cx + p.x*scale;
      const y = cy - p.y*scale;
      const hue = (i%5===0)? 50 : 335;
      const alpha = 0.65 + 0.35*Math.sin(beatT + i*0.12);
      ctx.fillStyle = `hsla(${hue} 85% 75% / ${Math.max(0,Math.min(1,alpha))})`;
      ctx.fillRect(x, y, 1.2*DPR, 1.2*DPR);
    }
    const rad = ctx.createRadialGradient(cx, cy, scale*0.9, cx, cy, scale*3.8);
    rad.addColorStop(0, "rgba(255,200,220,0.45)");
    rad.addColorStop(1, "rgba(10,10,19,0)");
    ctx.fillStyle = rad; ctx.beginPath(); ctx.arc(cx, cy, scale*3.8, 0, Math.PI*2); ctx.fill();
  }

  let last=performance.now();
  function loop(now=performance.now()){
    last=now;
    // nền đêm
    const g = ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0, "#0d0b18"); g.addColorStop(1, "#141326");
    ctx.fillStyle = g; ctx.fillRect(0,0,W,H);
    drawStarfield();
    drawHeart();
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);
})();

/* ===== Build video background AFTER Start ===== */
const videoFiles = [
  // TODO: thay bằng video thực trong assets/
  "assets/video1.mp4",
  "assets/video2.mp4",
  "assets/video3.mp4",
  "assets/video4.mp4",
  "assets/video5.mp4"
];
function buildVideoWall(){
  const wrap = $("#videoBG");
  wrap.innerHTML = "";

  // đảm bảo đúng 6 ô theo khu vực a..f
  const areas = ["a","b","c","d","e","f"];
  const files = videoFiles.slice(0,6); // lấy 6 file đầu (hoặc ít hơn)

  areas.forEach((area, i) => {
    const cell = document.createElement("div");
    cell.className = `vcell ${area}`;
    cell.dataset.area = area;

    const v = document.createElement("video");
    v.setAttribute("playsinline","");
    v.muted = true;
    v.loop = true;
    v.autoplay = true;
    v.src = files[i % files.length];

    // stagger fade-in để “lần lượt xuất hiện”
    v.style.animationDelay = `${0.08 * i}s, 0s`;

    // random seek nhẹ để khung hình khác nhau
    v.addEventListener("loadedmetadata", ()=>{
      try{
        const dur = Math.max(0, (v.duration || 12) - 1);
        v.currentTime = Math.random() * dur;
      }catch{}
      v.play().catch(()=>{});
    });

    cell.appendChild(v);
    wrap.appendChild(cell);
  });

  // hiển thị
  wrap.style.opacity = "1";
}


/* ===== Countdown (IDs đã chuyển vào intro) ===== */
(function setupCountdown(){
  const dd = $("#dd"), hh = $("#hh"), mm = $("#mm"), ss = $("#ss");
  function next2010(now = new Date()){
    const y = now.getFullYear();
    const targetThisYear = new Date(y, 9, 20, 0, 0, 0);
    return (now <= targetThisYear) ? targetThisYear : new Date(y+1, 9, 20, 0, 0, 0);
  }
  function tick(){
    const now = new Date();
    const tgt = next2010(now);
    const diff = tgt - now;
    if (diff <= 0){
      const el = document.querySelector(".intro-countdown");
      if (el) el.innerHTML = `<div class="icell"><div class="num">🎉</div><div class="lbl">Chúc mừng</div></div>`;
      return;
    }
    const s = Math.floor(diff/1000);
    const days = Math.floor(s/86400);
    const hrs = Math.floor((s%86400)/3600);
    const mins = Math.floor((s%3600)/60);
    const secs = s%60;
    dd.textContent = days; hh.textContent = String(hrs).padStart(2,"0");
    mm.textContent = String(mins).padStart(2,"0"); ss.textContent = String(secs).padStart(2,"0");
    requestAnimationFrame(()=>setTimeout(tick, 1000 - (Date.now()%1000)));
  }
  tick();
})();

/* ===== Typewriter ===== */
const lines = [
  "Em là điều dịu êm giữa cuộc sống vội vàng,",
  "là bình yên anh muốn quay về sau mỗi ngày dài,",
  "là nguồn cảm hứng động lực để anh tốt hơn từng chút một.",
  "Chúc Em 20/10 rực rỡ — anh luôn ở đây Với Em."
];
(function typewriter(){
  const box = $("#typewriter");
  let i=0, j=0, pause=900, speed=28;
  function write(){
    if (i >= lines.length) return;
    const line = lines[i];
    box.innerHTML = lines.slice(0,i).map(l=>`${l}<br>`).join("") + line.slice(0, j) + "<span style='opacity:.6'>|</span>";
    j++;
    if (j <= line.length) setTimeout(write, speed);
    else { i++; j=0; setTimeout(write, pause); }
  }
  write();
})();
$("#btnReveal")?.addEventListener("click", ()=> $("#fullLetter").classList.remove("hidden"));

/* ===== Audio + Start ===== */
const audio = $("#bgm");
$("#btnEnter").addEventListener("click", async ()=>{
  // 1) Fade out intro
  const intro = $("#intro");
  intro.style.transition = "opacity .8s ease";
  intro.style.opacity = "0";
  setTimeout(()=>{ intro.style.display = "none"; }, 820);

  // 2) Build & show video wall
  buildVideoWall();

  // 3) Play music
  try{ await audio.play(); }catch(e){}

  // 4) chút tim bay
  pulseHearts(18);
});
$("#btnMuteHint").addEventListener("click", ()=> alert("Nếu không nghe thấy, hãy bật volume thiết bị và bỏ chế độ im lặng (iOS)."));

/* ===== Modal ===== */
const backdrop = $("#backdrop");
$("#btnGift")?.addEventListener("click", ()=> backdrop.style.display="flex");
$("#btnClose")?.addEventListener("click", ()=> backdrop.style.display="none");
backdrop?.addEventListener("click", (e)=>{ if(e.target===backdrop) backdrop.style.display="none"; });

/* ===== Hearts Particles ===== */
const cvsHearts = $("#hearts");
const ctxHearts = cvsHearts.getContext("2d");
let HW=0, HH=0, heartParticles=[];
let heartsRunning = true;
function resizeHearts(){ HW = cvsHearts.width = Math.floor(innerWidth * DPR); HH = cvsHearts.height = Math.floor(innerHeight * DPR); }
addEventListener("resize", resizeHearts, {passive:true}); resizeHearts();

function heartPath(ctx, x,y, s, rot=0){
  ctx.save(); ctx.translate(x,y); ctx.rotate(rot); ctx.scale(s,s);
  ctx.beginPath(); ctx.moveTo(0, -10);
  ctx.bezierCurveTo(12, -24, 32, -10, 0, 18);
  ctx.bezierCurveTo(-32, -10, -12, -24, 0, -10);
  ctx.closePath(); ctx.restore();
}
function spawnHearts(n=12, x=HW/2, y=HH/2){
  for (let i=0;i<n;i++){
    const ang = Math.random()*Math.PI*2;
    const spd = 1 + Math.random()*2.2;
    heartParticles.push({
      x, y,
      vx: Math.cos(ang)*spd*DPR,
      vy: (Math.sin(ang)*spd - 1.1)*DPR,
      g: (0.018 + Math.random()*0.02)*DPR,
      a: 1,
      s: 0.8*DPR + Math.random()*1.4*DPR,
      r: Math.random()*Math.PI,
      vr: (Math.random()-.5)*0.055,
      color: ["#ff7aa2","#ff9fbe","#ffd1e1","#ffd96a"][Math.floor(Math.random()*4)]
    });
  }
}
function pulseHearts(n=14){
  const x = (Math.random()*HW*0.6)+HW*0.2;
  const y = (Math.random()*HH*0.4)+HH*0.2;
  spawnHearts(n, x, y);
}
let lastHearts = performance.now();
function loopHearts(now = performance.now()){
  if (!heartsRunning) return;
  lastHearts = now;
  ctxHearts.clearRect(0,0,HW,HH);
  for (let p of heartParticles){
    p.vy += p.g; p.x += p.vx; p.y += p.vy; p.r += p.vr; p.a *= 0.986;
  }
  heartParticles = heartParticles.filter(p => p.a>0.03 && p.y < HH+60*DPR);
  for (let p of heartParticles){
    ctxHearts.save(); ctxHearts.globalAlpha = p.a; ctxHearts.fillStyle = p.color;
    heartPath(ctxHearts, p.x, p.y, p.s, p.r); ctxHearts.fill(); ctxHearts.restore();
  }
  requestAnimationFrame(loopHearts);
}
requestAnimationFrame(loopHearts);
document.addEventListener("dblclick", ()=>pulseHearts(28));
$("#btnHearts")?.addEventListener("click", ()=>pulseHearts(24));

/* ===== Carousel pause on pointer ===== */
const track = $("#track");
let paused = false;
$("#carousel")?.addEventListener('pointerdown', ()=>{ track.style.animationPlayState='paused'; paused=true; });
addEventListener('pointerup', ()=>{ if(paused){ track.style.animationPlayState='running'; paused=false; } });

/* ===== Mini-quiz ===== */
const quiz = $("#quiz");
const quizResult = $("#quizResult");
if (quiz){
  const opts = [...quiz.querySelectorAll('.opt')];
  opts.forEach((el, idx)=>{
    el.addEventListener('click', ()=>{
      opts.forEach(o=>o.classList.remove('correct','wrong'));
      if (idx === 3){ el.classList.add('correct'); quizResult.textContent = "Chuẩn! Thực ra anh Thích tất tần tật về Em. 🥰"; pulseHearts(18); }
      else { el.classList.add('wrong'); quizResult.textContent = "Cũng đúng… nhưng đáp án chính xác nhất là: TẤT CẢ! 💖"; }
    });
  });
}

/* ===== Chips -> toast ===== */
const toast = $("#toast");
$("#chips")?.addEventListener('click', (e)=>{
  const chip = e.target.closest('.chip'); if (!chip) return;
  toast.textContent = `Okay! ${chip.textContent} — ghi sổ hẹn hò 💌`;
  toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 1600);
  pulseHearts(12);
});

/* ===== Secret press & hold ===== */
(function holdToReveal(){
  const btn = $("#btnSecret");
  if (!btn) return;
  let timer; let down=false;
  const secret = "Bí mật: Em chính là điều tuyệt vời nhất từng xảy ra với anh. — Yêu Em! 💗";
  const downHandler = ()=>{ if (down) return; down=true; timer = setTimeout(()=>{ alert(secret); pulseHearts(22); down=false; }, 1800); };
  const upHandler = ()=>{ clearTimeout(timer); down=false; };
  ['mousedown','touchstart'].forEach(ev=>btn.addEventListener(ev, downHandler));
  ['mouseup','mouseleave','touchend','touchcancel'].forEach(ev=>btn.addEventListener(ev, upHandler));
})();

/* ===== Pause loops when tab hidden ===== */
document.addEventListener("visibilitychange", ()=>{
  heartsRunning = !document.hidden;
  if (!document.hidden){
    requestAnimationFrame(loopHearts);
  }
});

// ===== Tilt cards (“Vì sao Em tuyệt?”) =====
(() => {
  const TILT_X = 6;   // độ nghiêng theo trục X (dọc)
  const TILT_Y = 8;   // độ nghiêng theo trục Y (ngang)
  const cards = document.querySelectorAll('.trait');
  if (!cards.length) return;

  cards.forEach(card => {
    let raf = 0;

    function setTilt(e, isTouch=false){
      const r = card.getBoundingClientRect();
      const cx = isTouch ? (e.touches?.[0].clientX ?? e.clientX) : e.clientX;
      const cy = isTouch ? (e.touches?.[0].clientY ?? e.clientY) : e.clientY;
      const x = (cx - r.left) / r.width;   // 0..1
      const y = (cy - r.top)  / r.height;  // 0..1
      const rx = (y - 0.5) * -TILT_X;
      const ry = (x - 0.5) *  TILT_Y;

      // throttle bằng rAF để mượt
      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(() => {
        card.style.transform = `perspective(700px) rotateX(${rx}deg) rotateY(${ry}deg)`;
        // cập nhật vị trí highlight
        card.style.setProperty('--lx', `${x*100}%`);
        card.style.setProperty('--ly', `${y*100}%`);
      });
    }

    function resetTilt(){
      cancelAnimationFrame(raf);
      card.style.transform = 'perspective(700px) rotateX(0) rotateY(0)';
      card.style.removeProperty('--lx');
      card.style.removeProperty('--ly');
    }

    // Chuột
    card.addEventListener('mousemove', setTilt);
    card.addEventListener('mouseleave', resetTilt);

    // Cảm ứng
    card.addEventListener('touchstart', e => setTilt(e, true), {passive:true});
    card.addEventListener('touchmove',  e => setTilt(e, true), {passive:true});
    card.addEventListener('touchend',   resetTilt, {passive:true});
    card.addEventListener('touchcancel',resetTilt, {passive:true});
  });
})();
</script>
</body>
</html>
